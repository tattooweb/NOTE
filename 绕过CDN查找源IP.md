### 绕过CDN查找真实源IP

#### 1. 多地ping http://ping.chinaz.com/

#### 2. ping xxx.com 非ping www.xxx.com

现有很多CDN厂商基本只要求把www.xxx.com cname到cdn主服务器上去，而且有人为了维护网站时更方便，不用等cdn缓存，只让WWW域名使用cdn，秃域名不使用。所以试着把目标网站的www去掉，ping一下看ip是不是变了

#### 3. 直接ping目标域名可直接判断

`www.baidu.com`与`www.a.shifen.com`不一致

```bash
C:\>ping www.baidu.com
正在 Ping www.a.shifen.com [183.232.231.172] 具有 32 字节的数据:
来自 183.232.231.172 的回复: 字节=32 时间=7ms TTL=56
来自 183.232.231.172 的回复: 字节=32 时间=6ms TTL=56
```

#### 4. ping二级域名、三级域名

因为很多情况是主站使用了CDN而分站没有使用，而且一般不会把所有的二级域名放在CDN上

最后将目标域名绑定到同ip，能访问就说明目标站与此二级域名在同一个服务器上，就算不在同一服务器也可能在同C段，扫描C段所有开80端口的ip，挨个试。

#### 5. 找国外冷门DNS

大部分CDN提供商只针对国内市场，而对国外市场几乎是不做CDN，国外的请求有很大的几率会直接指向真实ip。要找**冷门国外DNS**才行，像谷歌的DNS，国内用的人越来越多了，很多CDN提供商都把谷歌DNS作为国内市场之一，所以，你查到的结果会和国内差不了多少

8.8.8.8

8.8.4.4

208.67.222.222

156.154.71.1

198.153.194.1

199.85.127.10

例如：nslookup xxx.com 8.8.8.8

#### 6. 网站证书

浏览器获得证书序列号信息，上fofa搜索`cert="oct(序列号)"`，第一个就是真实IP

#### 7. 查看域名历史解析记录

#### 8. 让服务器主动连接我们

邮件、RSS订阅

可以获取到mail服务器的ip，如果恰好这个ip和源站ip比较近或者就是源站ip，就直接成功了

#### 9. 大流量访问

针对免费版的CDN，流量耗尽时就泄露真实IP。CDN除了能隐藏ip，可能还考虑到分配流量。不设防的CDN量大就会挂。高防CDN 要大流量访问。经受不住大流量冲击的时候可能会显示真实ip。

#### 10.特殊CDN记录

比如cloudflare默认会配direct.domain.com指向真实IP

#### 11. 探针文件

如果得到的二级、三级域名都做了CDN，那么可以尝试找找有没有探针文件，有探针文件，看server info就ok

#### 12. 社工

天眼查